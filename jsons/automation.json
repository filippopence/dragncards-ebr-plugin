{
    "automation": {
        "postNewGameActionList": [
            // ["LOAD_CARDS", "APerfectDay"],
            // ["LOAD_CARDS", "VoiceoftheElders"],
            // ["LOAD_CARDS", "Spire"],
            // ["LOAD_CARDS", ["LIST",
            //     {
            //     "databaseId": "03007",
            //     "quantity": 1,
            //     "loadGroupId": "sharedMissions"
            //     }]
            // ],
            ["DEFINE", "$PLAYER_N", "player1"],
            ["LOAD_CARDS", "challengeDeck"],
            ["LOAD_CARDS", "Reference"],
            ["LOAD_CARDS", "CoreMap"]
            //["LOAD_CARDS", "Maps"],
            //["LOAD_CARDS", "ScuttlerNetwork"]
        ],
        "postLoadActionList": [
            ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds",  // Play with Rebalanced Cards (Uncommon Wisdom)
                [["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                ["COND", 
                    ["AND", "$CARD.sides.A.UncommonWisdom", "$GAME.playerData.{{$PLAYER_N}}.rebalanced"],
                    ["SET", 
                        "/cardById/$CARD_ID/sides/A/imageUrl", 
                        "https://earthborne-rangers.s3.eu-west-3.amazonaws.com/Uncommon_Wisdom/{{$CARD.sides.A.databaseId}}.jpg"
                    ] 
                ]]
            ],
            ["DEFINE", "$LOADED_PLAYER_DECK", false],
            ["FOR_EACH_VAL", "$CARD_SET_ASIDE", "$GAME.groupById.sharedSetAside.parentCards", // Prevents from loading multiple copies of the same card
                [["VAR", "$i", 0],
                 ["FOR_EACH_VAL", "$COPY_LOADED_ID", "$GAME.loadedCardIds", [
                    ["VAR", "$COPY_LOADED", "$GAME.cardById.$COPY_LOADED_ID"],
                    ["COND", 
                        ["AND", 
                            ["LESS_THAN", "$i", 1],
                            ["EQUAL", "$COPY_LOADED.sides.A.name", "$CARD_SET_ASIDE.sides.A.name"],
                            ["NOT", ["EQUAL", "$COPY_LOADED.groupId", "sharedOther"]],
                            ["NOT", ["EQUAL", "$COPY_LOADED.sides.A.set", "Map"]],
                            ["NOT", ["EQUAL", "$COPY_LOADED.sides.A.set", "Reference"]]
                        ],
                        [["MOVE_CARD", "$COPY_LOADED_ID", "sharedOther", 0],
                         ["INCREASE_VAR", "$i", 1]
                        ]
                    ]
                ]]]
            ],
            ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds",  [ // Add 3 cards from the Valley/Arcology set to the Path Deck
                ["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                ["COND",  
                    ["AND", 
                        ["EQUAL", "$CARD.sides.A.type", "Location"], 
                        ["EQUAL", "$CARD.sides.A.pivotal", "0"] 
                    ],
                    [
                        ["TOGGLE_ENCOUNTER_2_DECK", false],
                        ["MOVE_CARD", "$CARD_ID", "sharedLocation", 0],
                        ["SET", "/cardById/$CARD_ID/currentSide", "B"],
                        ["LOG", "├── ", "Rangers arrived at ", "$CARD.sides.A.name", "."],
                        ["COND", 
                            ["EQUAL", "$CARD.sides.A.name", "Headwaters Station"],   // Headwaters Station
                            [   
                                ["SHUFFLE_GROUP", "sharedPathDeck3"],
                                ["SHUFFLE_GROUP", "sharedPathDeck"],
                                ["LOG", "├── ", "Shuffled 0 cards from the Valley set into the Path Deck."]
                            ],
                            ["EQUAL", "$CARD.sides.A.name", "Bowl of the Sun"],   // Bowl of the Sun
                            [   
                                ["SHUFFLE_GROUP", "sharedPathDeck3"],
                                ["VAR", "$i", 0],
                                ["FOR_EACH_VAL", "$iCARD", "$GAME.groupById.sharedPathDeck3.parentCards", [
                                    ["COND", 
                                        ["EQUAL", "$iCARD.sides.A.name", "The Fundamentalist"],
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0]
                                    ],
                                    ["COND",
                                        ["AND", 
                                        ["LESS_THAN", "$i", 2],
                                        ["OR",
                                            ["NOT", ["CHECK_IF_COPY_IN_PLAY", "$iCARD"]], 
                                            ["EQUAL", "$iCARD.sides.A.name", "Reclaimer Seeker"]
                                        ]],
                                        [
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0],
                                        ["DEFINE", "$iCARD_SET", "$iCARD.sides.A.set"],
                                        ["INCREASE_VAR", "$i", 1]
                                        ]
                                    ]
                                    ]],
                                ["SHUFFLE_GROUP", "sharedPathDeck"],
                                ["LOG", "├── ", "Shuffled {{$i}} cards from the {{$iCARD_SET}} set into the Path Deck."]
                            ],
                            ["EQUAL", "$CARD.sides.A.name", "Archaeological Outpost"], // Archaeological Outpost
                            [   
                                ["SHUFFLE_GROUP", "sharedPathDeck3"],
                                ["VAR", "$i", 0],
                                ["FOR_EACH_VAL", "$iCARD", "$GAME.groupById.sharedPathDeck3.parentCards", [
                                    ["COND", 
                                        ["EQUAL", "$iCARD.sides.A.name", "Arcology Sinkhole"],
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0]
                                    ],
                                    ["COND",
                                        ["AND", 
                                        ["LESS_THAN", "$i", 2],
                                        ["OR",
                                            ["NOT", ["CHECK_IF_COPY_IN_PLAY", "$iCARD"]], 
                                            ["EQUAL", "$iCARD.sides.A.name", "Reclaimer Seeker"]
                                        ]],
                                        [
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0],
                                        ["DEFINE", "$iCARD_SET", "$iCARD.sides.A.set"],
                                        ["INCREASE_VAR", "$i", 1]
                                        ]
                                    ]
                                    ]],
                                ["SHUFFLE_GROUP", "sharedPathDeck"],
                                ["LOG", "├── ", "Shuffled {{$i}} cards from the {{$iCARD_SET}} set into the Path Deck."]
                            ],
                            ["EQUAL", "$CARD.sides.A.name", "Oasis of Sunlight"], // Oasis of Sunlight
                            [   
                                ["SHUFFLE_GROUP", "sharedPathDeck2"],
                                ["SHUFFLE_GROUP", "sharedPathDeck3"],
                                ["VAR", "$i", 0],
                                ["VAR", "$ii", 0],
                                ["FOR_EACH_VAL", "$iCARD", "$GAME.groupById.sharedPathDeck2.parentCards", [
                                    ["COND",
                                        ["AND", 
                                        ["LESS_THAN", "$i", 3],
                                        ["OR",
                                            ["NOT", ["CHECK_IF_COPY_IN_PLAY", "$iCARD"]], 
                                            ["EQUAL", "$iCARD.sides.A.name", "Reclaimer Seeker"]
                                        ]],
                                        [
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0],
                                        ["DEFINE", "$iCARD_SET", "$iCARD.sides.A.set"],
                                        ["INCREASE_VAR", "$i", 1]
                                        ]
                                    ]
                                    ]],
                                ["FOR_EACH_VAL", "$iCARD", "$GAME.groupById.sharedPathDeck3.parentCards", [
                                    ["COND",
                                        ["AND", 
                                        ["LESS_THAN", "$ii", 3],
                                        ["OR",
                                            ["NOT", ["CHECK_IF_COPY_IN_PLAY", "$iCARD"]], 
                                            ["EQUAL", "$iCARD.sides.A.name", "Reclaimer Seeker"]
                                        ]],
                                        [
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0],
                                        ["DEFINE", "$iCARD_SET", "$iCARD.sides.A.set"],
                                        ["INCREASE_VAR", "$ii", 1]
                                        ]
                                    ]
                                    ]],
                                ["SHUFFLE_GROUP", "sharedPathDeck"],
                                ["LOG", "├── ", "Shuffled {{$ii}} cards from the {{$iCARD_SET}} set into the Path Deck."],
                                ["LOG", "├── ", "Shuffled {{$i}} cards from the Woods set into the Path Deck."]
                            ],
                        true,
                            [
                                ["SHUFFLE_GROUP", "sharedPathDeck3"],
                                ["VAR", "$i", 0],
                                ["FOR_EACH_VAL", "$iCARD", "$GAME.groupById.sharedPathDeck3.parentCards", [
                                    ["COND",
                                        ["AND", 
                                        ["LESS_THAN", "$i", 3],
                                        ["OR",
                                            ["NOT", ["CHECK_IF_COPY_IN_PLAY", "$iCARD"]], 
                                            ["EQUAL", "$iCARD.sides.A.name", "Reclaimer Seeker"]
                                        ]],
                                        [
                                        ["MOVE_CARD", "$iCARD.id", "sharedPathDeck", 0],
                                        ["DEFINE", "$iCARD_SET", "$iCARD.sides.A.set"],
                                        ["INCREASE_VAR", "$i", 1]
                                        ]
                                    ]
                                    ]],
                                ["SHUFFLE_GROUP", "sharedPathDeck"],
                                ["LOG", "├── ", "Shuffled {{$i}} cards from the {{$iCARD_SET}} set into the Path Deck."]
                            ]
                        ]
                    ] 
                ],
                ["COND",  
                    ["AND", 
                        ["EQUAL", "$CARD.sides.A.type", "Location"], 
                        ["EQUAL", "$CARD.sides.A.pivotal", "1"] 
                    ],
                    [
                        ["TOGGLE_ENCOUNTER_2_DECK", false],
                        ["MOVE_CARD", "$CARD_ID", "sharedLocation", 0],
                        ["SET", "/cardById/$CARD_ID/currentSide", "B"],
                        ["LOG", "├── ", "Rangers arrived at ", "$CARD.sides.A.name", "."]
                    ]
                ],
                ["COND", 
                    ["AND", 
                        ["EQUAL", "$CARD.sides.A.type", "Role"],
                        ["EQUAL", "$CARD.inPlay", true]
                    ],
                    [
                        ["DEFINE", "$LOADED_PLAYER_DECK", true]
                    ]
                ],
                ["COND",
                    ["EQUAL", "$CARD.sides.A.type", "Aspect"],
                    [
                        ["VAR", "$AWA_VALUE", "$CARD.sides.A.AWA"],
                        ["VAR", "$SPI_VALUE", "$CARD.sides.A.SPI"],
                        ["VAR", "$FIT_VALUE", "$CARD.sides.A.FIT"],
                        ["VAR", "$FOC_VALUE", "$CARD.sides.A.FOC"],
                        ["SET", "/cardById/$CARD_ID/tokens/awareness", "$AWA_VALUE"],
                        ["SET", "/cardById/$CARD_ID/tokens/spirit", "$SPI_VALUE"],
                        ["SET", "/cardById/$CARD_ID/tokens/fitness", "$FIT_VALUE"],
                        ["SET", "/cardById/$CARD_ID/tokens/focus", "$FOC_VALUE"],
                        ["LOG", "{{$ALIAS_N}} recharged their energy tokens."]
                    ]
                ],
                ["COND",
                    ["EQUAL", "$CARD.sides.A.type", "Location"],
                    ["SET", "/stepId", "3.5"]
                ],
                ["COND", 
                    ["EQUAL", "$CARD.sides.A.name", "Howling Winds"],
                    [
                        ["LOAD_CARDS", "CerberusianCyclone"]
                    ]
                ],
                ["COND", 
                    ["EQUAL", "$CARD.sides.A.name", "Electric Fog"],
                    [
                        ["LOAD_CARDS", "BallLightning"]
                    ]
                ] ]
            ],
            ["DEFINE", "$PLAYER_N_HAND_GROUP_ID", ["JOIN_STRING", "$PLAYER_N", "Hand"]],
            ["COND", // Draw first 6 cards
                ["AND", "$LOADED_PLAYER_DECK", ["EQUAL", "$GAME.roundNumber", 0], ["EQUAL", ["LENGTH", "$GAME.groupById.$PLAYER_N_HAND_GROUP_ID.stackIds"], 0]],
                [
                    ["LOG", "└── ", "$PLAYER_N", " draws 6 cards."],
                    ["DRAW_CARD", 6]
                ]
            ],
            ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds",  // Set shared controller
                [["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                ["COND",
                  ["OR", 
                    ["EQUAL", "$CARD.sides.A.name", "The Spiral Stairway"], 
                    ["EQUAL", "$CARD.sides.A.name", "The Plinth"],
                    ["EQUAL", "$CARD.sides.A.name", "Flooded Passage"],
                    ["EQUAL", "$CARD.sides.A.name", "Overgrown Passage"],
                    ["EQUAL", "$CARD.sides.A.name", "Locked Passage"]
                 ],
                  ["SET", "/cardById/$CARD_ID/controller", "shared"] ] ]
            ],
            ["COND", // Define Active Location
             ["GREATER_THAN", ["LENGTH", "$GAME.groupById.sharedLocation.stackIds"], 0],
             ["DEFINE", "$ACTIVE_LOCATION", "$GAME.groupById.sharedLocation.parentCards.[0]"]
            ],
            ["COND", // Move The Spiral Stairway along the way when travelling to The Chimney from Spire
                ["AND", 
                 ["DEFINED", "$PREV_LOCATION"], 
                 ["EQUAL", "$PREV_LOCATION.sides.A.name", "Spire"],
                 ["EQUAL", "$ACTIVE_LOCATION.sides.A.name", "The Chimney"]
                ],
                [
                    ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds", [
                        ["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.name", "The Spiral Stairway"],
                            ["MOVE_CARD", "$CARD_ID", "sharedAlongTheWay", -1]
                        ],
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.name", "The Plinth"],
                            [["MOVE_CARD", "$CARD_ID", "sharedPathDeck", -1],
                             ["SHUFFLE_GROUP", "sharedPathDeck"]]
                        ]]
                    ]
                 
                ]
            ],
            ["COND", // Setup for Scuttler Network
                ["AND", 
                 ["DEFINED", "$PREV_LOCATION"], 
                 ["EQUAL", "$PREV_LOCATION.sides.A.name", "Terminal Artery"],
                 ["EQUAL", "$ACTIVE_LOCATION.sides.A.name", "Scuttler Network"],
                 ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                 ],
                 [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds", [
                        ["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.name", "Flooded Passage"],
                            ["DELETE_CARD", "$CARD_ID"]
                        ]]
                    ],
                    ["LOAD_CARDS", "FloodedPassage"]
                 ]                 
            ],
            ["COND", // Setup for Terminal Artery
                ["AND", 
                 ["DEFINED", "$PREV_LOCATION"], 
                 ["EQUAL", "$PREV_LOCATION.sides.A.name", "Carbonforged Maze"],
                 ["EQUAL", "$ACTIVE_LOCATION.sides.A.name", "Terminal Artery"],
                 ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                 ],
                 [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds", [
                        ["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.name", "Overgrown Passage"],
                            ["DELETE_CARD", "$CARD_ID"]
                        ]]
                    ],
                    ["LOAD_CARDS", "LockedPassage"]
                 ]                 
            ],
            ["COND", // Setup for Orlin's Vault
                ["AND", 
                 ["DEFINED", "$PREV_LOCATION"], 
                 ["EQUAL", "$PREV_LOCATION.sides.A.name", "Branching Artery"],
                 ["EQUAL", "$ACTIVE_LOCATION.sides.A.name", "Orlin's Vault"],
                 ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                 ],
                 [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD_ID", "$GAME.loadedCardIds", [
                        ["VAR", "$CARD", "$GAME.cardById.$CARD_ID"],
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.name", "Overgrown Passage"],
                            ["DELETE_CARD", "$CARD_ID"]
                        ]]
                    ],
                    ["LOAD_CARDS", "LockedPassage"]
                 ]                 
            ],
            ["COND", // Remove Prev. Maps and loads Core Maps
                ["AND", 
                ["DEFINED", "$PREV_LOCATION"],
                ["EQUAL", "$PREV_LOCATION.sides.A.pack_code", "Core"],
                ["EQUAL", "$ACTIVE_LOCATION.sides.A.pack_code", "LoA"],
                ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                ],
                [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedSetAside.parentCards", 
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.set", "Map"],
                            ["DELETE_CARD", "$CARD.id"]
                        ]
                    ],
                    ["LOAD_CARDS", "ArcologyMap"]
                ],
             true,
                ["COND",
                ["AND", 
                ["DEFINED", "$PREV_LOCATION"],
                ["EQUAL", "$PREV_LOCATION.sides.A.pack_code", "LoA"],
                ["EQUAL", "$ACTIVE_LOCATION.sides.A.pack_code", "Core"],
                ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                ],
                [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedSetAside.parentCards", 
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.set", "Map"],
                            ["DELETE_CARD", "$CARD.id"]
                        ]
                    ],
                    ["LOAD_CARDS", "CoreMap"]]
                ]
            ],
            ["COND", // Remove Prev. Maps and loads Arcology Maps
                ["AND", 
                ["NOT", ["DEFINED", "$PREV_LOCATION"]],
                ["DEFINED", "$ACTIVE_LOCATION"],
                ["EQUAL", "$ACTIVE_LOCATION.sides.A.pack_code", "LoA"],
                ["NOT", ["DEFINED", "$LOOP_ONCE"]]
                ],
                [
                    ["DEFINE", "$LOOP_ONCE", true],
                    ["FOR_EACH_VAL", "$CARD", "$GAME.groupById.sharedSetAside.parentCards", 
                        ["COND",  
                            ["EQUAL", "$CARD.sides.A.set", "Map"],
                            ["DELETE_CARD", "$CARD.id"]
                        ]
                    ],
                    ["LOAD_CARDS", "ArcologyMap"]]
            ]
        ],
        "gameRules":{ 
                "AddGeneralToken": {
                    "_comment": "Add general tokens when card enters play.",
                    "type": "trigger", 
                    "listenTo": ["/cardById/*/inPlay", "/cardById/*/currentSide"],
                    "condition": ["AND", 
                                    "$TARGET.inPlay",
                                    ["GREATER_EQUAL", "$TARGET.currentFace.generic_token", 0], 
                                    ["PREV", ["NOT", "$TARGET.inPlay"]]
                                ],
                    "then": ["COND",
                                    ["EQUAL", "$TARGET.currentSide", "A"],
                                    ["COND", 
                                        ["EQUAL", "$TARGET.currentFace.scaleGenericTokenPerPlayer", true],
                                        ["SET", "/cardById/$TARGET_ID/tokens/general", ["MULTIPLY", "$TARGET.currentFace.generic_token", "$GAME.numPlayers"]],
                                    true,
                                        ["SET", "/cardById/$TARGET_ID/tokens/general", "$TARGET.currentFace.generic_token"]
                                    ]
                            ]
                },
                "ColorBorderBlue": {
                    "_comment": "Turn cards blue when they have enought progress tokens on them.",
                    "type": "passive", 
                    "listenTo": ["/cardById/*/tokens/progress", "/cardById/*/tokens"],
                    "condition": ["AND", 
                        ["NOT_EQUAL", "$TARGET.currentFace.progress_threshold", null],
                        ["GREATER_THAN", "$TARGET.tokens.progress", 0],
                        ["COND",
                            ["EQUAL", "$TARGET.currentFace.scaleProgressThresholdPerPlayer", true],
                            ["GREATER_EQUAL", "$TARGET.tokens.progress", ["MULTIPLY", "$TARGET.currentFace.progress_threshold", "$GAME.numPlayers"]],
                            true,
                            ["GREATER_EQUAL", "$TARGET.tokens.progress", "$TARGET.currentFace.progress_threshold"]
                        ]
                    ],
                    "onDo": [
                        ["LOG", "└── ", "$TARGET.currentFace.name", " is cleared by progress."],
                        ["SET", "/cardById/$TARGET_ID/borderColor", "blue"]
                    ],
                    "offDo": [
                        ["SET", "/cardById/$TARGET_ID/borderColor", null]
                    ]
                },
                "ColorBorderRed": {
                    "_comment": "Turn cards red when they have enought harm tokens on them.",
                    "type": "passive", 
                    "listenTo": ["/cardById/*/tokens/harm", "/cardById/*/tokens"],
                    "condition": ["AND", 
                        ["NOT_EQUAL", "$TARGET.currentFace.harm_threshold", null],
                        ["GREATER_THAN", "$TARGET.tokens.harm", 0],
                        ["COND",
                            ["EQUAL", "$TARGET.currentFace.scaleHarmThresholdPerPlayer", true],
                            ["GREATER_EQUAL", "$TARGET.tokens.harm", ["MULTIPLY", "$TARGET.currentFace.harm_threshold", "$GAME.numPlayers"]],
                            true,
                            ["GREATER_EQUAL", "$TARGET.tokens.harm", "$TARGET.currentFace.harm_threshold"]
                        ]
                    ],
                    "onDo": [
                        ["LOG", "└── ", "$TARGET.currentFace.name", " is cleared by harm."],
                        ["SET", "/cardById/$TARGET_ID/borderColor", "red"]
                    ],
                    "offDo": [
                        ["SET", "/cardById/$TARGET_ID/borderColor", null]
                    ]
                }
            },
        "cards": {
            "01284": {"_comment": "Cloudhive Swarm",
                "rules": {
                    "AddABee": {    "_comment": "Add generic token on Refresh.",
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"]],
                        "then": [["COND",
                                    ["EQUAL", "$THIS.currentSide", "A"],
                                    [
                                        ["LOG", "└── ", "Added 1 Bee to ", "$THIS.currentFace.name", "."],
                                        ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/general", 1]
                                    ]
                                ]]
                        }
                    }
            },
            "01268": {"_comment": "Circling Irix",
                "rules": {
                    "isPersistent": {    "_comment": "Circling Irix",
                        "type": "trigger",
                        "listenTo": ["/cardById/$THIS_ID/inPlay"],
                        "condition": [
                            "AND", "$THIS.inPlay"
                        ],
                        "then": [
                            ["SET", "/cardById/$THIS_ID/controller", "playerNull"],
                            ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/persistent", 1],
                            ["LOG", "└── ", "$THIS.currentFace.name", " gains Persistent."]
                        ]
                        }
                    }
            },
            "01316": {"_comment": "Quisi Vos, Rascal",
                "inheritFrom": "01268"
            },
            "01317": {"_comment": "Ren Kobo",
                "inheritFrom": "01268"
            },
            "01326": {"_comment": "Umbra",
                "inheritFrom": "01268"
            },
            "01373": {"_comment": "A Perfect Day / Midday Sun",
                "rules": {
                    "Trigger1": {    "_comment": "Trigger for A Perfect Day.",
                        "type": "trigger",
                        "listenTo": ["/stepId"],
                        "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"], ["EQUAL", "$THIS.currentSide", "A"], ["EQUAL", ["PREV", "$THIS.currentSide"], "A"]],
                        "then": [[
                                    ["LOG", "└── ", "Removed 1 cloud from ", "$THIS.currentFace.name", "."],
                                    ["DECREASE_VAL", "/cardById/$THIS_ID/tokens/general", 1]
                                ],
                                ["COND",
                                    ["LESS_EQUAL", "$THIS.tokens.general", 1],
                                    [["SET", "/cardById/$THIS_ID/currentSide", "B"],
                                    ["LOG", "└── The weather has changed!"]]
                                ]]
                    },
                    "Trigger2": {    "_comment": "Trigger for Midday Sun.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"], ["EQUAL", "$THIS.currentSide", "B"]],
                    "then": [
                                ["LOG", "└── ", "Added 1 cloud to ", "$THIS.currentFace.name", "."],
                                ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/general", 1],
                                ["COND",
                                    ["GREATER_EQUAL", "$THIS.tokens.general", 2],
                                    [["SET", "/cardById/$THIS_ID/currentSide", "A"],
                                    ["LOG", "└── The weather has changed!"]]]
                            ]
                    }
                }
            },
            "01374": {"_comment": "Gathering Storm",
                "rules":
                    {    "Trigger": {"_comment": "Trigger for Gathering Storm.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "1"], ["EQUAL", "$THIS.currentSide", "B"]],
                    "then": [[
                                ["LOG", "└── ", "Added 2 rain to ", "$THIS.currentFace.name", "."],
                                ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/general", 2]
                            ],
                            ["COND",
                                ["GREATER_EQUAL", "$THIS.tokens.general", 2],   
                                [["SET", "/cardById/$THIS_ID/currentSide", "A"],
                                ["LOG", "└── The weather has changed!"],
                                ["FOR_EACH_KEY_VAL", "$CARD_ID", "$CARD", "$GAME.cardById", [
                                    ["COND",
                                        ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.type", "Role"]],
                                        ["SET", "/cardById/$CARD_ID/rotation", 90]
                                    ],
                                    ["COND",
                                        ["AND", "$CARD.inPlay", ["IN_STRING", "$CARD.currentFace.traits", "Prey"]],
                                        ["MOVE_CARD", "$CARD_ID", "sharedAlongTheWay", -1]
                                    ]
                                    ]]
                                ]
                            ]]}
                    }
            },
            "01375": {"_comment": "Howling Winds / Thunderhead",
                "rules": {
                    "Trigger1": {    "_comment": "Refresh for Howling Winds.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"], ["EQUAL", "$THIS.currentSide", "A"]],
                    "then": [["COND",
                                ["GREATER_EQUAL", "$THIS.tokens.general", ["MULTIPLY", 3 , "$GAME.numPlayers"]],
                                [["LOG", "└── The weather has changed!"],
                                ["SET", "/cardById/$THIS_ID/currentSide", "B"],
                                ["SET", "/cardById/$THIS_ID/tokens/general", 0],
                                ["ACTION_LIST", "revealPathFaceup", true, "sharedPathDeck", "$GAME.firstPlayer"]]
                            ]]
                    },
                    "Trigger2": {   "_comment": "Arrival Setup for Howling Winds.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "3.5"], ["EQUAL", "$THIS.currentSide", "A"]],
                    "then": [
                        ["VAR", "$CERBERUSIAN_CYCLONE_IN_GAME", false],
                        ["FOR_EACH_KEY_VAL", "$TARGET_ID", "$TARGET", "$GAME.cardById", [
                            ["COND",
                                ["EQUAL", "$TARGET.sides.A.name", "Cerberusian Cyclone"],
                                ["VAR", "$CERBERUSIAN_CYCLONE_IN_GAME", true]
                            ]]],
                        ["COND", 
                            ["EQUAL", "$CERBERUSIAN_CYCLONE_IN_GAME", false],
                            [
                                ["LOAD_CARDS", "CerberusianCyclone"],
                                ["LOG", "Cerberusian Cyclone shuffled in the path deck."]
                            ]
                        ]]
                    },
                    "Trigger3": {    "_comment": "Trigger for Thunderhead.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"], ["EQUAL", "$THIS.currentSide", "B"]],
                    "then": [
                                [["LOG", "└── The weather has changed!"],
                                ["SET", "/cardById/$THIS_ID/currentSide", "A"]]
                            ]
                    }
                }
            },
            "01376": {"_comment": "Clinging Mist / Electric Fog",
                "rules": {
                    "Trigger1": {    "_comment": "Refresh for Clinging Mist.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", "$THIS.inPlay", ["EQUAL", "$GAME.stepId", "4.1"], ["EQUAL", "$THIS.currentSide", "B"]],
                    "then": [[
                                ["LOG", "└── ", "Added 2 fog to ", "$THIS.currentFace.name", "."],
                                ["INCREASE_VAL", "/cardById/$THIS_ID/tokens/general", 2]
                            ],
                            ["COND",
                                ["GREATER_EQUAL", "$THIS.tokens.general", 2],   
                                [["SET", "/cardById/$THIS_ID/currentSide", "A"],
                                ["LOG", "└── The weather has changed!"]
                                ]
                            ]]
                    },
                    "Trigger2": {   "_comment": "Arrival Setup for Electric Fog.",
                    "type": "trigger",
                    "listenTo": ["/stepId"],
                    "condition": ["AND", ["EQUAL", "$GAME.stepId", "3.5"], ["EQUAL", "$THIS.currentSide", "A"]],
                    "then": [
                        ["VAR", "$BALL_LIGHTNING_IN_GAME", false],
                        ["FOR_EACH_KEY_VAL", "$TARGET_ID", "$TARGET", "$GAME.cardById", [
                            ["COND",
                                ["EQUAL", "$TARGET.sides.A.name", "Ball Lightning"],
                                ["VAR", "$BALL_LIGHTNING_IN_GAME", true]
                            ]]],
                        ["COND", 
                            ["EQUAL", "$BALL_LIGHTNING_IN_GAME", false],
                            [
                                ["LOAD_CARDS", "BallLightning"],
                                ["LOG", "Ball Lightning shuffled in the path deck."]
                            ]
                        ]]
                    }
                }
            }, 
            "01410": {"_comment": "Alluvial Ruins",
                "rules": {
                    "pathDeckAssembly": {
                        "type": "trigger",
                        "listenTo": ["/cardById/*/inPlay"],
                        "condition":["AND", ["GREATER_EQUAL", ["LENGTH", "sharedPathDeck2"], 0], ["EQUAL", "$TARGET.groupId", "sharedLocation"]],
                        "then": [   
                                    ["TOGGLE_ENCOUNTER_2_DECK", true]
                        ]  
                    }}
            }, 
            "01385": {"_comment": "Spire",
                "inheritFrom": "01410"
            },
            "01415": {"_comment": "Helping Hand",
                "rules": {
                "PersistenKeyword": {"_comment": "Helping Hand",
                    "type": "passive",
                    "listenTo": [
                        "/cardById/$THIS_ID/inPlay",
                        "/cardById/$THIS_ID/cardIndex"  
                    ],
                    "condition": [
                    "AND",
                        "$THIS.inPlay",
                        ["GREATER_THAN", "$THIS.cardIndex", 0]
                    ],
                    "onDo": [
                        ["SET", "/cardById/$THIS.parentCardId/controller", "playerNull"],
                        ["INCREASE_VAL", "/cardById/$THIS.parentCardId/tokens/persistent", 1],
                        ["LOG", "└── ", "$GAME.cardById.{{$THIS.parentCardId}}.currentFace.name", " gains Persistent."]
                    ],
                    "offDo": [
                        ["VAR", "$PREV_PARENT_ID",["PREV","$THIS.parentCardId"]],
                        ["SET", "/cardById/$PREV_PARENT_ID/controller", "shared"],
                        ["DECREASE_VAL", "/cardById/$PREV_PARENT_ID/tokens/persistent", 1],
                        ["LOG", "└── ", "$GAME.cardById.{{$PREV_PARENT_ID}}.currentFace.name", " loses Persistent."]
                    ]
                    }
                }
            },
            "01416": {"_comment": "Helping Hand",
                "inheritFrom": "01415"
            },
            "01419": {"_comment": "Rising Waters / The Watcher in the Brush",
                "rules": {
                        "RisingWaters": {
                            "type": "trigger",
                            "listenTo": ["/cardById/*/inPlay"],
                            "condition": [
                                    "AND", 
                                        "$THIS.inPlay", 
                                        ["EQUAL", "$THIS.currentSide", "A"],
                                        "$TARGET.inPlay", 
                                        ["OR", ["EQUAL", "$TARGET.sides.A.name", "White Sky"], ["EQUAL", "$TARGET.sides.A.name", "Kobo's Market"], ["EQUAL", "$TARGET.sides.A.name", "Golden Shore"]], 
                                        ["PREV", ["NOT", "$TARGET.inPlay"]]
                                    ],
                            "then": [
                                    ["PROMPT", "player1", "RISING_WATERS"]
                            ]
                        },
                        "TheWatcherInTheBrush": {
                            "type": "trigger",
                            "listenTo": ["/cardById/*/inPlay"],
                            "condition": [
                                    "AND", 
                                        "$THIS.inPlay", 
                                        ["EQUAL", "$THIS.currentSide", "B"],
                                        "$TARGET.inPlay", 
                                        ["EQUAL", "$TARGET.sides.A.type", "Location"], 
                                        ["PREV", ["NOT", "$TARGET.inPlay"]]
                                    ],
                            "then": [
                                    ["LOAD_CARDS", ["LIST",
                                        {
                                        "databaseId": "01330",
                                        "quantity": 1,
                                        "loadGroupId": "sharedPathDeck"
                                        }]
                                    ],
                                    ["LOG", "├── ", "Mysterious Verdessian added into the path deck."]
                            ]
                        }}
            },
            "01420": {"_comment": "Sensor Network / Secret Invasion",
                "rules": {
                        "SecretInvasion": {
                            "type": "trigger",
                            "listenTo": ["/cardById/*/inPlay"],
                            "condition": [
                                    "AND", 
                                        "$THIS.inPlay", 
                                        ["EQUAL", "$THIS.currentSide", "B"],
                                        "$TARGET.inPlay", 
                                        ["EQUAL", "$TARGET.sides.A.type", "Location"], 
                                        ["EQUAL", "$TARGET.sides.A.pivotal", "0"],
                                        ["PREV", ["NOT", "$TARGET.inPlay"]]
                                    ],
                            "then": [
                                    ["LOAD_CARDS", ["LIST",
                                        {
                                        "databaseId": "01332",
                                        "quantity": 5,
                                        "loadGroupId": "sharedPathDeck3"
                                        }]
                                    ],
                                    ["LOG", "├── ", "5 Reclaimer Seekers shuffled into the Valley set."]
                            ]
                        }}
            },
            "01426": {"_comment": "Invasion - Stage 1 / Invasion - Stage 2",
                "rules": {
                        "Stage1": {
                            "type": "trigger",
                            "listenTo": ["/cardById/*/inPlay"],
                            "condition": ["AND", 
                                    "$THIS.inPlay", 
                                    ["EQUAL", "$THIS.currentSide", "A"],
                                    "$TARGET.inPlay", 
                                    ["EQUAL", "$TARGET.sides.A.type", "Location"], 
                                    ["PREV", ["NOT", "$TARGET.inPlay"]], 
                                    ["OR", ["IN_STRING", "$TARGET.currentFace.traits", "Ruin"], ["IN_STRING", "$TARGET.currentFace.traits", "Forest"], ["IN_STRING", "$TARGET.currentFace.traits", "Mountain"]]],
                            "then": [
                                    ["PROMPT", "player1", "INVASION_STAGE1", "$TARGET"]
                            ]
                        },
                        "Stage2": {
                            "type": "trigger",
                            "listenTo": ["/cardById/*/inPlay"],
                            "condition": ["AND", 
                                    "$THIS.inPlay", 
                                    ["EQUAL", "$THIS.currentSide", "B"],
                                    "$TARGET.inPlay", 
                                    ["EQUAL", "$TARGET.sides.A.type", "Location"], 
                                    ["PREV", ["NOT", "$TARGET.inPlay"]], 
                                    ["OR", ["IN_STRING", "$TARGET.currentFace.traits", "Ruin"], ["IN_STRING", "$TARGET.currentFace.traits", "Forest"], ["IN_STRING", "$TARGET.currentFace.traits", "Mountain"]]],
                            "then": [
                                    ["LOAD_CARDS", ["LIST",
                                        { 
                                        "databaseId": "01333",
                                        "quantity": 1,
                                        "loadGroupId": "sharedPathDeck"
                                        }]
                                    ],
                                    ["PROMPT", "player1", "INVASION_STAGE2"]
                            ]
                        }}
            },
            "01360": {"_comment": "The Arcology Threshold",
                "ability": {
                    "A": ["PROMPT", "$PLAYER_N", "ARCOLOGY_THRESHOLD"]
                }
            },
            "01320": {"_comment": "Arcology Sinkhole",
                "ability": {
                    "A": ["PROMPT", "$PLAYER_N", "ARCOLOGY_SINKHOLE"]
                }
            }
        }
    }
}
